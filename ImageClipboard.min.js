window.ImageClipboard=function(e,t){function n(e){var t;e.clipboardData&&e.clipboardData.items?(t=e.clipboardData.items,t&&(t=Array.prototype.filter.call(t,function(e){return e.type.indexOf("image")>=0}),Array.prototype.forEach.call(t,function(e){var t=e.getAsFile(),n=window.URL||window.webkitURL,i=n.createObjectURL(t);d(i)}))):r&&setTimeout(function(){var e=r.firstElementChild;e&&"IMG"==e.tagName&&d(e.src)},5)}function i(){var e=document.createElement("div");return e.setAttribute("id","paste_catcher"),e.setAttribute("contenteditable",""),e.style.opacity=0,document.body.appendChild(e),e.focus(),document.addEventListener("click",function(){e.focus()}),e}var r,a,o=document.querySelector(e),c=this;window.Clipboard||(r=i()),window.addEventListener("paste",n);var d=function(e){var n=new Image;o.innerHTML="",n.onload=function(){var e=document.createElement("img");e.src=n.src,e.style.maxHeight="100%",e.style.maxHeight="100%",o.appendChild(e),r&&(r.innerHTML=""),a=n,t&&t(c)},n.src=e},l=function(){return a},u=function(){for(var e;e=o.lastChild;)o.removeChild(e);if(r){for(;e=r.lastChild;)r.removeChild(e);document.body.removeChild(r)}a=null};return{el:o,getImage:l,destroy:u}};